<udebs>

<definitions>

    <lists>
        <item>colour</item>
        <item>sprite</item>
        <item>status</item>
    </lists>
    <stats>
        <item>ACT</item>
        <item>SPD</item>
    </stats>
    
</definitions>


<scripts>
    <!--
    <tick>
        <item>TARGET CHANGE ACT [TARGET STAT SPD * time]</item>
    </tick>
    -->
    <init>
        <item>Bpawn RECRUIT (0,1)</item>
        <item>Bpawn RECRUIT (1,1)</item>
        <item>Bpawn RECRUIT (2,1)</item>
        <item>Bpawn RECRUIT (3,1)</item>
        <item>Bpawn RECRUIT (4,1)</item>
        <item>Bpawn RECRUIT (5,1)</item>
        <item>Bpawn RECRUIT (6,1)</item>
        <item>Bpawn RECRUIT (7,1)</item>
        <item>Brook RECRUIT (0,0)</item>
        <item>Brook RECRUIT (7,0)</item>
        <item>Bknight RECRUIT (1,0)</item>
        <item>Bknight RECRUIT (6,0)</item>
        <item>Bbishop RECRUIT (2,0)</item>
        <item>Bbishop RECRUIT (5,0)</item>
        <item>Bking RECRUIT (3,0)</item>
        <item>Bqueen RECRUIT (4,0)</item>
        <item>Wpawn RECRUIT (0,6)</item>
        <item>Wpawn RECRUIT (1,6)</item>
        <item>Wpawn RECRUIT (2,6)</item>
        <item>Wpawn RECRUIT (3,6)</item>
        <item>Wpawn RECRUIT (4,6)</item>
        <item>Wpawn RECRUIT (5,6)</item>
        <item>Wpawn RECRUIT (6,6)</item>
        <item>Wpawn RECRUIT (7,6)</item>
        <item>Wrook RECRUIT (0,7)</item>
        <item>Wrook RECRUIT (7,7)</item>
        <item>Wknight RECRUIT (1,7)</item>
        <item>Wknight RECRUIT (6,7)</item>
        <item>Wbishop RECRUIT (2,7)</item>
        <item>Wbishop RECRUIT (5,7)</item>
        <item>Wking RECRUIT (3,7)</item>
        <item>Wqueen RECRUIT (4,7)</item>
    </init>
    
</scripts> 

<map>
    <dim>
        <x>8</x>
        <y>8</y>
    </dim>
</map>

<entities>
    
    <!-- move classes -->
    <entity>
        <ID>player_block</ID>
        <require>
            <item>CASTER CLASS player not in TARGET STAT group</item>
        </require>
    </entity>
    
    <entity>
        <ID>player_move</ID>
        <effect>
            <!-- <item>CASTER CLASS player CHANGE ACT ( - CASTER ACT )</item> -->
            <item>CASTER CAST moved_once</item>
            <item>TARGET CAST captured</item>
        </effect>
        <require>
            <!--<item>CASTER STAT ACT &gt;= 2</item>-->
        </require>
    </entity>
    
    <entity>
        <ID>pawn_white</ID>
        <require>
            <item>TARGET POSITION y &lt; CASTER POSITION y</item>
        </require>
        <effect>
            <item>CASTER CAST W_promote</item>
        </effect>
    </entity>
    
    <entity>
        <ID>pawn_black</ID>
        <require>
            <item>TARGET POSITION y &gt; CASTER POSITION y</item>
        </require>
        <effect>
            <item>CASTER CAST B_promote</item>
        </effect>
    </entity>
    
    <entity>
        <ID>pawn_travel</ID>
        <effect>
            <item>TRAVEL</item>
        </effect>
        <require>
            <item>DISTANCE y == 1</item>
            <item>DISTANCE x == 0</item>
            <item>TARGET == empty</item>            
        </require>
    </entity>
    
    <entity>
        <ID>pawn_double</ID>
        <effect>
            <item>TRAVEL</item>
            <item>CASTER CAST passant_danger</item>
        </effect>
        <require>
            <item>moved_once not in CASTER STAT status</item>
            <item>DISTANCE x == 0</item>
            <item>DISTANCE y == 2</item>
            <item>TARGET == empty</item>
            <item>BLOCK y</item>
        </require>
    </entity>
    
    <entity>
        <ID>pawn_capture</ID>
        <effect>
            <item>TRAVEL</item>
        </effect>
        <require>
            <item>DISTANCE pinf == 1</item>
            <item>DISTANCE x == DISTANCE y</item>
            <item>TARGET != empty</item>
            <item>CASTER CLASS player not in TARGET STAT group</item>
        </require>
    </entity>
    
    <entity>
        <ID>pawn_passant</ID>
        <effect>
            <item>TARGET BUMP</item>
        </effect>
        <require>
            <item>passant_danger in TARGET STAT status</item>
            <item>DISTANCE x == 1</item>
            <item>DISTANCE y == 0</item>
        </require>
    </entity>
    
    <!-- statuses -->
    
    <entity>
        <ID>W_promote</ID>
        <require>
            <item>TARGET POSITION y == 0</item>
            <item>white_pawn in TARGET STAT group</item>
        </require>
        <effect>
            <item>Wqueen RECRUIT [TARGET POSITION x , TARGET POSITION y]</item>
        </effect>
    </entity>
    
    <entity>
        <ID>B_promote</ID>
        <require>
            <item>TARGET POSITION y == 7</item>
            <item>black_pawn in TARGET STAT group</item>
        </require>
        <effect>
            <item>Bqueen RECRUIT [TARGET POSITION x , TARGET POSITION y]</item>
        </effect>
    </entity>
    
    <entity>
        <ID>moved_once</ID>
        <require>
            <item>SELF not in TARGET STAT status</item>
        </require>
        <effect>
            <item>TARGET GETS status SELF</item>
        </effect>
    </entity>
    
    <entity>
        <ID>passant_danger</ID>
        <require>
            <item>SELF not in TARGET STAT status</item>
        </require>
        <effect>
            <item>TARGET GETS status SELF</item>
            <item>TARGET CAST passant_remove DELAY 2</item>
        </effect>
    </entity>
    
    <entity>
        <ID>captured</ID>
        <effect>
            <item>TARGET GETS status SELF</item>
        </effect>
        
        <require>
            <item>SELF not in TARGET STAT status</item>
            <item>CASTER CLASS player not in TARGET STAT group</item>
            <item>TARGET != empty</item>
        </require>
    </entity>
    
    <!-- moves -->
    
    <entity>
        <ID>white_pawn_travel</ID>
        <group>
            <item>player_block</item>
            <item>player_move</item>
            <item>pawn_travel</item>
            <item>pawn_white</item>
        </group>
    </entity>
    
    <entity>
        <ID>white_pawn_double</ID>
        <group>
            <item>player_block</item>
            <item>player_move</item>
            <item>pawn_double</item>
            <item>pawn_white</item>
        </group>
    </entity>
    
    <entity>
        <ID>white_pawn_capture</ID>
        <group>
            <item>player_block</item>
            <item>player_move</item>
            <item>pawn_capture</item>
            <item>pawn_white</item>
        </group>
    </entity>
    
    <entity>
        <ID>white_pawn_passant</ID>
        <effect>
            <item>TARGET CAST W_qpassant</item>
            <item>TARGET CAST W_kpassant</item>
        </effect>
        <group>
            <item>player_block</item>
            <item>player_move</item>
            <item>pawn_passant</item>
        </group>
    </entity>
    
    <entity>
        <ID>black_pawn_travel</ID>
        <group>
            <item>player_block</item>
            <item>player_move</item>
            <item>pawn_travel</item>
            <item>pawn_black</item>
        </group>
    </entity>
    
    <entity>
        <ID>black_pawn_double</ID>
        <group>
            <item>player_block</item>
            <item>player_move</item>
            <item>pawn_double</item>
            <item>pawn_black</item>
        </group>
    </entity>
    
    <entity>
        <ID>black_pawn_capture</ID>
        <group>
            <item>player_block</item>
            <item>player_move</item>
            <item>pawn_capture</item>
            <item>pawn_black</item>
        </group>
    </entity>
    
    <entity>
        <ID>black_pawn_passant</ID>
        <effect>
            <item>TARGET CAST B_qpassant</item>
            <item>TARGET CAST B_kpassant</item>
        </effect>
        <group>
            <item>player_block</item>
            <item>player_move</item>
            <item>pawn_passant</item>
        </group>
    </entity>
    
    <entity>
        <ID>rook_travel</ID>
        <effect>
            <item>TRAVEL</item>
        </effect>
        <require>
            <item>( DISTANCE p1 == DISTANCE x ) or ( DISTANCE p1 == DISTANCE y )</item>
            <item>BLOCK x</item>
        </require>
        <group>
            <item>player_block</item>
            <item>player_move</item>
        </group>
    </entity>
    
    <entity>
        <ID>bishop_travel</ID>
        <effect>
            <item>TRAVEL</item>
        </effect>
        <require>
            <item>DISTANCE pinf == DISTANCE x</item>
            <item>DISTANCE pinf == DISTANCE y</item>
            <item>BLOCK diag</item>
        </require>
        <group>
            <item>player_block</item>
            <item>player_move</item>
        </group>
    </entity>
    
    <entity>
        <ID>knight_travel</ID>
        <effect>
            <item>TRAVEL</item>
        </effect>
        <require>
            <item>( DISTANCE x == 2 and DISTANCE y == 1 ) or ( DISTANCE x == 1 and DISTANCE y == 2 )</item>
        </require>
        <group>
            <item>player_block</item>
            <item>player_move</item>
        </group>
    </entity>
    
    <entity>
        <ID>king_travel</ID>
        <effect>
            <item>TRAVEL</item>
        </effect>
        <require>
            <item>DISTANCE pinf == 1</item>
        </require>
        <group>
            <item>player_block</item>
            <item>player_move</item>
        </group>
    </entity>
    
    <entity>
        <ID>king_castle</ID>
        <effect>
            <item>TARGET CAST king_qcastle</item>
            <item>TARGET CAST king_kcastle</item>
        </effect>
        <require>
            <item>CASTER CLASS player in TARGET STAT group</item>
            <item>rook in TARGET STAT group</item>
            <item>moved_once not in CASTER STAT status</item>
            <item>moved_once not in TARGET STAT status</item>
            <item>BLOCK x</item>
        </require>
        <group>
            <item>player_move</item>
        </group>
    </entity>

<!-- Chain Casting Moves and Checks -->
    <entity>
        <ID>passant_remove</ID>
        <effect>
            <item>TARGET LOSES status passant_danger</item>
        </effect>
    </entity>
    
    <entity>
        <ID>king_qcastle</ID>
        <effect>
            <item>CASTER MOVE x 2</item>
            <item>TARGET MOVE x -3</item>
        </effect>
        <require>
            <item>'2' in TARGET</item>
        </require>
    </entity>
    
    <entity>
        <ID>king_kcastle</ID>
        <effect>
            <item>CASTER MOVE x -2</item>
            <item>TARGET MOVE x 2</item>
        </effect>
        <require>
            <item>'1' in TARGET</item>
        </require>
    </entity>
    
    <entity>
        <ID>W_qpassant</ID>
        <require>
            <item>TARGET POSITION x &lt; CASTER POSITION x</item>
        </require>
        <effect>
            <item>CASTER MOVE xy (-1,-1)</item>
        </effect>
    </entity>
    
    <entity>
        <ID>W_kpassant</ID>
        <require>
            <item>TARGET POSITION x &gt; CASTER POSITION x</item>
        </require>
        <effect>
            <item>CASTER MOVE xy (1,-1)</item>
        </effect>
    </entity>
    
    <entity>
        <ID>B_qpassant</ID>
        <require>
            <item>TARGET POSITION x &lt; CASTER POSITION x</item>
        </require>
        <effect>
            <item>CASTER MOVE xy (-1,1)</item>
        </effect>
    </entity>
    
    <entity>
        <ID>B_kpassant</ID>
        <require>
            <item>TARGET POSITION x &gt; CASTER POSITION x</item>
        </require>
        <effect>
            <item>CASTER MOVE xy (1,1)</item>
        </effect>
    </entity>
</entities>

<units>
    <!-- Unit classes -->
    <unit>
        <type>player</type>
        <ID>black</ID>     
        <stats>
            <ACT>1</ACT>
            <SPD>1</SPD>
        </stats>
        <colour>
            <item>3</item>
            <item>100</item>
            <item>3</item>
        </colour>
    </unit>
    
    <unit>
        <type>player</type>
        <ID>white</ID>     
        <stats>
            <ACT>2</ACT>
            <SPD>1</SPD>
        </stats>
        <colour>
            <item>100</item>
            <item>3</item>
            <item>100</item>
        </colour>
    </unit>
    
    <unit>
        <ID>white_pawn</ID>     
        <movelist>
            <item>white_pawn_travel</item>
            <item>white_pawn_double</item>
            <item>white_pawn_capture</item>
            <item>white_pawn_passant</item>
        </movelist>
        <sprite>
            <item>P</item>
        </sprite> 
    </unit>
    
    <unit>
        <ID>black_pawn</ID>     
        <movelist>
            <item>black_pawn_travel</item>
            <item>black_pawn_double</item>
            <item>black_pawn_capture</item>
            <item>black_pawn_passant</item>
        </movelist>
        <sprite>
            <item>P</item>
        </sprite> 
    </unit>
    
    <unit>
        <ID>bishop</ID>     
        <movelist>
            <item>bishop_travel</item>
        </movelist>
        <sprite>
            <item>B</item>
        </sprite> 
    </unit>
    
    <unit>
        <ID>rook</ID>     
        <movelist>
            <item>rook_travel</item>
        </movelist>
        <sprite>
            <item>R</item>
        </sprite> 
    </unit>
    
    <unit>
        <ID>queen</ID>     
        <movelist>
            <item>bishop_travel</item>
            <item>rook_travel</item>
        </movelist>
        <sprite>
            <item>Q</item>
        </sprite> 
    </unit>
    
    <unit>
        <ID>king</ID>     
        <movelist>
            <item>king_castle</item>
            <item>king_travel</item>
        </movelist>
        <sprite>
            <item>K</item>
        </sprite> 
    </unit>
    
    <unit>
        <ID>knight</ID>     
        <movelist>
            <item>knight_travel</item>
        </movelist>
        <sprite>
            <item>N</item>
        </sprite> 
    </unit>
    
    <!-- white clonables -->
    
    <unit>
        <ID>Wpawn</ID>     
        <group>
            <item>white</item>
            <item>white_pawn</item>
        </group> 
    </unit>
    
    <unit>
        <ID>Wrook</ID>     
        <group>
            <item>white</item>
            <item>rook</item>
        </group> 
    </unit>
    
    <unit>
        <ID>Wbishop</ID>     
        <group>
            <item>white</item>
            <item>bishop</item>
        </group> 
    </unit>

    <unit>
        <ID>Wknight</ID>     
        <group>
            <item>white</item>
            <item>knight</item>
        </group> 
    </unit>
    
    <unit>
        <ID>Wqueen</ID>     
        <group>
            <item>white</item>
            <item>queen</item>
        </group> 
    </unit>
    
    <unit>
        <ID>Wking</ID>     
        <group>
            <item>white</item>
            <item>king</item>
        </group> 
    </unit>
   
    <!-- black clonables -->
    
    <unit>
        <ID>Bpawn</ID>     
        <group>
            <item>black</item>
            <item>black_pawn</item>
        </group> 
    </unit>
    
    <unit>
        <ID>Brook</ID>     
        <group>
            <item>black</item>
            <item>rook</item>
        </group> 
    </unit>
    
    <unit>
        <ID>Bbishop</ID>     
        <group>
            <item>black</item>
            <item>bishop</item>
        </group> 
    </unit>
    
    <unit>
        <ID>Bknight</ID>     
        <group>
            <item>black</item>
            <item>knight</item>
        </group> 
    </unit>
    
    <unit>
        <ID>Bqueen</ID>     
        <group>
            <item>black</item>
            <item>queen</item>
        </group> 
    </unit>
    
    <unit>
        <ID>Bking</ID>     
        <group>
            <item>black</item>
            <item>king</item>
        </group> 
    </unit> 
</units>

</udebs>
