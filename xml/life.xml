<udebs>

<config>
    <revert>5</revert>
    <version>2</version>
    <logging>False</logging>
    <seed>4643</seed>
    <name>life</name>
</config>

<definitions>
    <stats>
        <NBR />
        <LIFE />
    </stats>

    <lists>
        <save />
    </lists>
</definitions>

<maps>
    <map type="diag">
        <dim>
            <x>50</x>
            <y>50</y>
        </dim>
    </map>
</maps>

<entities>

    <!-- Objects -->
    <cell />

    <change>
        <effect>
            <i>neighbors = FILL.$target.empty.false.1</i>
            <i>DELAY `(tick save GETS $neighbors) 0</i>
        </effect>
    </change>

    <!-- Life -->
    <life>
        <group>change</group>
        <require>$target.STAT.LIFE == 0</require>
        <effect>
            <i>$target LIFE REPLACE 1</i>
            <i>DELAY `($neighbors NBR += 1) 0</i>
        </effect>
    </life>

    <autolife>
        <group>life</group>
        <require>$target.STAT.NBR == 3</require>
    </autolife>

    <randomlife>
        <group>life</group>
        <require>DICE.4 == 0</require>
        <effect>tick save GETS $target.LOC</effect>
    </randomlife>

    <!-- Death -->
    <death>
        <group>change</group>
        <require>
            <i>$target.STAT.LIFE == 1</i>
            <i>($target.STAT.NBR &lt; 2) or ($target.STAT.NBR &gt; 3)</i>
        </require>
        <effect>
            <i>$target LIFE REPLACE 0</i>
            <i>DELAY `($neighbors NBR -= 1) 0</i>
        </effect>
    </death>

    <!-- Scripts -->
    <init>
        <effect>
            <i>all = (FILL (1 1) empty)</i>
            <i>cell RECRUIT $all</i>
            <i>CAST $all randomlife</i>
        </effect>
    </init>

    <tick>
        <effect>
            <i>all = (dedup $move.STAT.save)</i>
            <i>CAST $all death</i>
            <i>CAST $all autolife</i>
            <i>tick CLEAR save</i>
        </effect>
    </tick>
</entities>
</udebs>
